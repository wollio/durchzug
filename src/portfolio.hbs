{{!< default}}
{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

<script>

  let thresholdArray = [];
  for (let i = 0.0; i <= 1.0; i+=0.001) {
    thresholdArray.push(i);
  }

  const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);

  const options = {
    rootMargin: vh+'px 0px -'+vh*0.5+"px 0px",
    threshold: thresholdArray, // Full intersection into the root element
  };

  let callback = (entries, observer) => {
    entries.forEach(entry => {
      let text = entry.target.getElementsByTagName("div")[0];
      let width = text.getBoundingClientRect().width - entry.target.getBoundingClientRect().width;
      text.style["left"] = "-" + width * (entry.intersectionRatio) + "px";
    });
  };

  let observer = new IntersectionObserver(callback, options);

  window.addEventListener('load', () => {
    let elements = document.getElementsByClassName("intersectionObserved");
    for (let element of elements) {
      observer.observe(element);
    }

  });

</script>

{{!-- The main content area --}}
<main id="site-main">
  <div class="md:container px-4 md:px-0 mx-auto mb-32">
    <!--div class="vh-2-3 flex justify-center items-center text-6xl text-center font-semibold">
      {{@site.description}}
    </div-->
    {{#foreach posts}}

      <article class="{{post_class}} mt-32 vh-2-3 intersectionObserved relative overflow-hidden rounded-2xl shadow bg-black">
        <div class="card-body absolute z-40 px-32 h-full bg-white bg-opacity-10">

          <a class="text-white italic" href="{{url}}">
            <h2 class="text-2-3-vh font-semibold whitespace-nowrap leading-none">{{title}}</h2>
          </a>

        </div>{{!--/.post-card-content--}}

        {{#if feature_image}}
          <a class="post-card-image-link z-30" href="{{url}}">
            {{!-- This is a responsive image, it loads different sizes depending on device
            https://medium.freecodecamp.org/a-guide-to-responsive-images-with-ready-to-use-templates-c400bd65c433 --}}
            <img class="post-card-image min-h-full object-cover filter blur-sm opacity-90 transform scale-125"
                 srcset="{{img_url feature_image size="s"}} 300w,
                    {{img_url feature_image size="m"}} 600w,
                    {{img_url feature_image size="l"}} 1000w,
                    {{img_url feature_image size="xl"}} 2000w"
                 sizes="100vw"
                 src="{{img_url feature_image size="m"}}"
                 alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
                 loading="lazy"
            />
          </a>
        {{/if}}
      </article>

    {{/foreach}}

  </div>
</main>
